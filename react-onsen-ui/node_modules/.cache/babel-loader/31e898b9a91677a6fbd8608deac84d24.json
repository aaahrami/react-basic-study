{"ast":null,"code":"/*\nCopyright 2013-2015 ASIAL CORPORATION\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\nimport onsElements from '../ons/elements.js';\nimport util from '../ons/util.js';\nimport autoStyle from '../ons/autostyle.js';\nimport ModifierUtil from '../ons/internal/modifier-util.js';\nimport AnimatorFactory from '../ons/internal/animator-factory.js';\nimport { PopoverAnimator, IOSFadePopoverAnimator, MDFadePopoverAnimator } from './ons-popover/animator.js';\nimport platform from '../ons/platform.js';\nimport iPhoneXPatch from '../ons/iphonex-patch.js';\nimport BaseDialogElement from './base/base-dialog.js';\nimport contentReady from '../ons/content-ready.js';\nconst scheme = {\n  '.popover': 'popover--*',\n  '.popover-mask': 'popover-mask--*',\n  '.popover__content': 'popover--*__content',\n  '.popover__arrow': 'popover--*__arrow'\n};\nconst _animatorDict = {\n  'default': function () {\n    return platform.isAndroid() ? MDFadePopoverAnimator : IOSFadePopoverAnimator;\n  },\n  'none': PopoverAnimator,\n  'fade-ios': IOSFadePopoverAnimator,\n  'fade-md': MDFadePopoverAnimator\n};\nconst positions = {\n  up: 'bottom',\n  left: 'right',\n  down: 'top',\n  right: 'left'\n};\nconst directions = Object.keys(positions);\n/**\n * @element ons-popover\n * @category dialog\n * @description\n *  [en]\n *    A component that displays a popover next to an element. The popover can be used to display extra information about a component or a tooltip.\n *\n *    To use the element it can either be attached directly to the `<body>` element or dynamically created from a template using the `ons.createPopover(template)` utility function and the `<template>` tag.\n *\n *    Another common way to use the popover is to display a menu when a button on the screen is tapped. For Material Design, popover looks exactly as a dropdown menu.\n *  [/en]\n *  [ja]ある要素を対象とするポップオーバーを表示するコンポーネントです。[/ja]\n * @codepen ZYYRKo\n * @tutorial vanilla/Reference/popover\n * @guide theming.html#modifiers [en]More details about the `modifier` attribute[/en][ja]modifier属性の使い方[/ja]\n * @example\n * <ons-button onclick=\"showPopover(this)\">\n *   Click me!\n * </ons-button>\n *\n * <ons-popover direction=\"down\" id=\"popover\">\n *   <p>This is a popover!</p>\n * </ons-popover>\n *\n * <script>\n *   var showPopover = function(element) {\n *     var popover = document.getElementById('popover');\n *     popover.show(element);\n *   };\n * </script>\n */\n\nexport default class PopoverElement extends BaseDialogElement {\n  /**\n   * @event preshow\n   * @description\n   *   [en]Fired just before the popover is displayed.[/en]\n   *   [ja]ポップオーバーが表示される直前に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   * @param {Function} event.cancel\n   *   [en]Call this function to stop the popover from being shown.[/en]\n   *   [ja]この関数を呼び出すと、ポップオーバーの表示がキャンセルされます。[/ja]\n   */\n\n  /**\n   * @event postshow\n   * @description\n   *   [en]Fired just after the popover is displayed.[/en]\n   *   [ja]ポップオーバーが表示された直後に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   */\n\n  /**\n   * @event prehide\n   * @description\n   *   [en]Fired just before the popover is hidden.[/en]\n   *   [ja]ポップオーバーが隠れる直前に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   * @param {Function} event.cancel\n   *   [en]Call this function to stop the popover from being hidden.[/en]\n   *   [ja]この関数を呼び出すと、ポップオーバーが隠れる処理をキャンセルします。[/ja]\n   */\n\n  /**\n   * @event posthide\n   * @description\n   *   [en]Fired just after the popover is hidden.[/en]\n   *   [ja]ポップオーバーが隠れた後に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   */\n\n  /**\n   * @event dialogcancel\n   * @description\n   * [en]Fired when the popover is canceled.[/en]\n   * [ja][/ja]\n   */\n\n  /**\n   * @attribute modifier\n   * @type {String}\n   * @description\n   *  [en]The appearance of the popover.[/en]\n   *  [ja]ポップオーバーの表現を指定します。[/ja]\n   */\n\n  /**\n   * @attribute direction\n   * @type {String}\n   * @description\n   *  [en]\n   *    A space separated list of directions. If more than one direction is specified,\n   *    it will be chosen automatically. Valid directions are `\"up\"`, `\"down\"`, `\"left\"` and `\"right\"`.\n   *  [/en]\n   *  [ja]\n   *    ポップオーバーを表示する方向を空白区切りで複数指定できます。\n   *    指定できる方向は、\"up\", \"down\", \"left\", \"right\"の4つです。空白区切りで複数指定することもできます。\n   *    複数指定された場合、対象とする要素に合わせて指定した値から自動的に選択されます。\n   *  [/ja]\n   */\n\n  /**\n   * @attribute cancelable\n   * @description\n   *   [en]If this attribute is set the popover can be closed by tapping the background or by pressing the back button.[/en]\n   *   [ja]この属性があると、ポップオーバーが表示された時に、背景やバックボタンをタップした時にをポップオーバー閉じます。[/ja]\n   */\n\n  /**\n   * @attribute cover-target\n   * @description\n   *   [en]If set the popover will cover the target on the screen.[/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @property coverTarget\n   * @description\n   *   [en]If set the popover will cover the target on the screen.[/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @attribute animation\n   * @type {String}\n   * @description\n   *   [en]The animation used when showing an hiding the popover. Can be either `\"none\"`, `\"default\"`, `\"fade-ios\"` or `\"fade-md\"`.[/en]\n   *   [ja]ポップオーバーを表示する際のアニメーション名を指定します。[/ja]\n   */\n\n  /**\n   * @attribute animation-options\n   * @type {Expression}\n   * @description\n   *  [en]Specify the animation's duration, timing and delay with an object literal. E.g. `{duration: 0.2, delay: 1, timing: 'ease-in'}`.[/en]\n   *  [ja]アニメーション時のduration, timing, delayをオブジェクトリテラルで指定します。e.g. {duration: 0.2, delay: 1, timing: 'ease-in'}[/ja]\n   */\n\n  /**\n   * @property animationOptions\n   * @type {Object}\n   * @description\n   *   [en]Specify the animation's duration, timing and delay with an object literal. E.g. `{duration: 0.2, delay: 1, timing: 'ease-in'}`.[/en]\n   *   [ja]アニメーション時のduration, timing, delayをオブジェクトリテラルで指定します。例：{duration: 0.2, delay: 1, timing: 'ease-in'}[/ja]\n   */\n\n  /**\n   * @attribute mask-color\n   * @type {Color}\n   * @description\n   *   [en]Color of the background mask. Default is `\"rgba(0, 0, 0, 0.2)\"`.[/en]\n   *   [ja]背景のマスクの色を指定します。デフォルトは\"rgba(0, 0, 0, 0.2)\"です。[/ja]\n   */\n\n  /**\n   * @attribute visible\n   * @type {Boolean}\n   * @description\n   *   [en]Whether the popover is visible or not.[/en]\n   *   [ja]要素が見える場合に`true`。[/ja]\n   */\n  constructor() {\n    super();\n    this._boundOnChange = this._onChange.bind(this);\n    contentReady(this, () => {\n      this._compile();\n\n      this.style.display = 'none';\n    });\n  }\n\n  get _scheme() {\n    return scheme;\n  }\n\n  get _mask() {\n    return util.findChild(this, '.popover-mask');\n  }\n\n  get _popover() {\n    return util.findChild(this, '.popover');\n  }\n\n  get _content() {\n    return util.findChild(this._popover, '.popover__content');\n  }\n\n  get _arrow() {\n    return util.findChild(this._popover, '.popover__arrow');\n  }\n\n  _updateAnimatorFactory() {\n    return new AnimatorFactory({\n      animators: _animatorDict,\n      baseClass: PopoverAnimator,\n      baseClassName: 'PopoverAnimator',\n      defaultAnimation: this.getAttribute('animation') || 'default'\n    });\n  }\n\n  _toggleStyle(shouldShow) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (shouldShow) {\n      this.style.display = 'block';\n      this._currentTarget = options.target;\n\n      this._positionPopover(options.target);\n    } else {\n      this.style.display = 'none';\n\n      this._clearStyles();\n    }\n  }\n\n  _positionPopover(target) {\n    const {\n      _radius: radius,\n      _content: contentElement,\n      _margin: margin\n    } = this;\n    const safeAreaLengths = iPhoneXPatch.getSafeAreaLengths();\n    const safeAreaRect = iPhoneXPatch.getSafeAreaDOMRect();\n    const targetRect = target.getBoundingClientRect();\n    const isMD = util.hasModifier(this, 'material');\n    const cover = isMD && this.hasAttribute('cover-target');\n    const parent = util.findParent(this, 'ons-page') || document.body;\n    const parentDimensions = parent.getBoundingClientRect();\n    const maxPositions = {\n      top: Math.max(parentDimensions.top, safeAreaRect.top),\n      left: Math.max(parentDimensions.left, safeAreaRect.left),\n      bottom: Math.min(parentDimensions.bottom, safeAreaRect.bottom),\n      right: Math.min(parentDimensions.right, safeAreaRect.right)\n    }; // Distance from each side of the safe area (with margin) to the target element\n\n    const targetDistance = {\n      top: targetRect.top - (maxPositions.top + margin),\n      left: targetRect.left - (maxPositions.left + margin),\n      bottom: maxPositions.bottom - margin - targetRect.bottom,\n      right: maxPositions.right - margin - targetRect.right\n    }; // Distance from each side of the safe area (with margin) to the geometric center of the target element\n\n    const targetCenterDistanceFrom = {\n      top: targetRect.top + Math.round(targetRect.height / 2) - (maxPositions.top + margin),\n      left: targetRect.left + Math.round(targetRect.width / 2) - (maxPositions.left + margin),\n      bottom: maxPositions.bottom - margin - targetRect.bottom + Math.round(targetRect.height / 2),\n      right: maxPositions.right - margin - targetRect.right + Math.round(targetRect.width / 2)\n    };\n\n    const {\n      vertical,\n      primary: primaryDirection,\n      secondary: secondaryDirection\n    } = this._calculateDirections(targetDistance);\n\n    this._currentDirection = primaryDirection;\n    util.addModifier(this, primaryDirection);\n    const sizeName = vertical ? 'width' : 'height'; // Get .popover__content size\n\n    const contentSize = (style => ({\n      width: parseInt(style.getPropertyValue('width'), 10),\n      height: parseInt(style.getPropertyValue('height'), 10)\n    }))(window.getComputedStyle(contentElement)); // Setting .popover position.\n\n\n    const targetAndArrowLength = cover ? 0 : (vertical ? targetRect.height : targetRect.width) + (isMD ? 0 : 14);\n    const primaryOffset = Math.max(safeAreaLengths[primaryDirection] + margin, safeAreaLengths[primaryDirection] + margin + targetDistance[primaryDirection] + targetAndArrowLength);\n    const secondaryOffset = Math.max(safeAreaLengths[secondaryDirection] + margin, safeAreaLengths[secondaryDirection] + margin + targetCenterDistanceFrom[secondaryDirection] - contentSize[sizeName] / 2);\n    this._popover.style[primaryDirection] = primaryOffset + 'px';\n    this._popover.style[secondaryDirection] = secondaryOffset + 'px'; // Setting .popover__arrow position.\n\n    this._arrow.style[secondaryDirection] = Math.max(radius, safeAreaLengths[secondaryDirection] + margin + targetCenterDistanceFrom[secondaryDirection] - secondaryOffset) + 'px';\n  }\n\n  _calculateDirections(distance) {\n    const options = (this.getAttribute('direction') || 'up down left right').split(/\\s+/).map(e => positions[e]);\n    const primary = options.sort((a, b) => distance[a] - distance[b])[0];\n    const vertical = 'top' == primary || 'bottom' == primary;\n    let secondary;\n\n    if (vertical) {\n      secondary = distance.left < distance.right ? 'left' : 'right';\n    } else {\n      secondary = distance.top < distance.bottom ? 'top' : 'bottom';\n    }\n\n    return {\n      vertical,\n      primary,\n      secondary\n    };\n  }\n\n  _clearStyles() {\n    this._currentDirection = null;\n    ['top', 'bottom', 'left', 'right'].forEach(e => {\n      this._arrow.style[e] = this._content.style[e] = this._popover.style[e] = '';\n      util.removeModifier(this, e);\n    });\n  }\n\n  _onChange() {\n    setImmediate(() => {\n      if (this._currentTarget) {\n        this._positionPopover(this._currentTarget);\n      }\n    });\n  }\n\n  _compile() {\n    autoStyle.prepare(this);\n\n    if (this._popover && this._mask) {\n      return;\n    }\n\n    const hasDefaultContainer = this._popover && this._content;\n\n    if (hasDefaultContainer) {\n      if (!this._mask) {\n        const mask = document.createElement('div');\n        mask.classList.add('popover-mask');\n        this.insertBefore(mask, this.firstChild);\n      }\n\n      if (!this._arrow) {\n        const arrow = document.createElement('div');\n        arrow.classList.add('popover__arrow');\n\n        this._popover.appendChild(arrow);\n      }\n    } else {\n      const template = util.createFragment(`\n        <div class=\"popover-mask\"></div>\n        <div class=\"popover\">\n          <div class=\"popover__content\"></div>\n          <div class=\"popover__arrow\"></div>\n        </div>\n      `);\n      const content = template.querySelector('.popover__content');\n\n      while (this.childNodes[0]) {\n        content.appendChild(this.childNodes[0]);\n      }\n\n      this.appendChild(template);\n    } // FIXME!\n\n\n    if (this.hasAttribute('style')) {\n      this._popover.setAttribute('style', this.getAttribute('style'));\n\n      this.removeAttribute('style');\n    }\n\n    ModifierUtil.initModifier(this, this._scheme);\n  }\n  /**\n   * @method show\n   * @signature show(target, [options])\n   * @param {String|Event|HTMLElement} target\n   *   [en]Target element. Can be either a CSS selector, an event object or a DOM element. It can be also provided as 'options.target' instead. [/en]\n   *   [ja]ポップオーバーのターゲットとなる要素を指定します。CSSセレクタかeventオブジェクトかDOM要素のいずれかを渡せます。[/ja]\n   * @param {Object} [options]\n   *   [en]Parameter object.[/en]\n   *   [ja]オプションを指定するオブジェクト。[/ja]\n   * @param {String} [options.animation]\n   *   [en]Animation name.  Use one of `\"fade-ios\"`, `\"fade-md\"`, `\"none\"` and `\"default\"`.[/en]\n   *   [ja]アニメーション名を指定します。\"fade-ios\", \"fade-md\", \"none\", \"default\"のいずれかを指定できます。[/ja]\n   * @param {String} [options.animationOptions]\n   *   [en]Specify the animation's duration, delay and timing. E.g. `{duration: 0.2, delay: 0.4, timing: 'ease-in'}`.[/en]\n   *   [ja]アニメーション時のduration, delay, timingを指定します。e.g. {duration: 0.2, delay: 0.4, timing: 'ease-in'}[/ja]\n   * @param {Function} [options.callback]\n   *   [en]This function is called after the popover has been revealed.[/en]\n   *   [ja]ポップオーバーが表示され終わった後に呼び出される関数オブジェクトを指定します。[/ja]\n   * @description\n   *   [en]Open the popover and point it at a target. The target can be either an event, a CSS selector or a DOM element..[/en]\n   *   [ja]対象とする要素にポップオーバーを表示します。target引数には、$eventオブジェクトやDOMエレメントやCSSセレクタを渡すことが出来ます。[/ja]\n   * @return {Promise}\n   *   [en]Resolves to the displayed element[/en]\n   *   [ja][/ja]\n   */\n\n\n  show(target) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    // Copy options and include options.target\n    if (target && typeof target === 'object' && !(target instanceof Event) && !(target instanceof HTMLElement)) {\n      options = { ...target\n      };\n    } else {\n      options = { ...options,\n        target\n      };\n    }\n\n    if (typeof options.target === 'string') {\n      options.target = document.querySelector(options.target);\n    } else if (options.target instanceof Event) {\n      options.target = options.target.target;\n    }\n\n    if (!(options.target instanceof HTMLElement)) {\n      util.throw('Invalid target type or undefined');\n    }\n\n    return super.show(options);\n  }\n  /**\n   * @method hide\n   * @signature hide([options])\n   * @param {Object} [options]\n   *   [en]Parameter object.[/en]\n   *   [ja]オプションを指定するオブジェクト。[/ja]\n   * @param {String} [options.animation]\n   *   [en]Animation name.  Use one of `\"fade-ios\"`, `\"fade-md\"`, `\"none\"` and `\"default\"`.[/en]\n   *   [ja]アニメーション名を指定します。\"fade-ios\", \"fade-md\", \"none\", \"default\"のいずれかを指定できます。[/ja]\n   * @param {String} [options.animationOptions]\n   *   [en]Specify the animation's duration, delay and timing. E.g. `{duration: 0.2, delay: 0.4, timing: 'ease-in'}`.[/en]\n   *   [ja]アニメーション時のduration, delay, timingを指定します。e.g. {duration: 0.2, delay: 0.4, timing: 'ease-in'}[/ja]\n   * @param {Function} [options.callback]\n   *   [en]This functions is called after the popover has been hidden.[/en]\n   *   [ja]ポップオーバーが隠れた後に呼び出される関数オブジェクトを指定します。[/ja]\n   * @description\n   *   [en]Close the popover.[/en]\n   *   [ja]ポップオーバーを閉じます。[/ja]\n   * @return {Promise}\n   *   [en]Resolves to the hidden element[/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @property visible\n   * @type {Boolean}\n   * @description\n   *   [en]Whether the element is visible or not.[/en]\n   *   [ja]要素が見える場合に`true`。[/ja]\n   */\n\n  /**\n   * @property cancelable\n   * @type {Boolean}\n   * @description\n   *   [en]\n   *     A boolean value that specifies whether the popover is cancelable or not.\n   *\n   *     When the popover is cancelable it can be closed by tapping the background or by pressing the back button on Android devices.\n   *   [/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @property onDeviceBackButton\n   * @type {Object}\n   * @description\n   *   [en]Back-button handler.[/en]\n   *   [ja]バックボタンハンドラ。[/ja]\n   */\n\n  /**\n   * @property maskColor\n   * @type {String}\n   * @default rgba(0, 0, 0, 0.2)\n   * @description\n   *  [en]Color of the background mask. Default is \"rgba(0, 0, 0, 0.2)\".[/en]\n   *  [ja]背景のマスクの色を指定します。\"rgba(0, 0, 0, 0.2)\"がデフォルト値です。[/ja]\n   */\n\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('resize', this._boundOnChange, false);\n    this._margin = this._margin || parseInt(window.getComputedStyle(this).getPropertyValue('top'));\n    this._margin = this._margin || 6; // Fix for iframes\n\n    contentReady(this, () => {\n      this._radius = parseInt(window.getComputedStyle(this._content).getPropertyValue('border-top-left-radius'));\n    });\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    window.removeEventListener('resize', this._boundOnChange, false);\n  }\n\n  static get observedAttributes() {\n    return [...super.observedAttributes, 'direction'];\n  }\n\n  attributeChangedCallback(name, last, current) {\n    if (name === 'direction') {\n      return this._boundOnChange();\n    } else if (name === 'modifier') {\n      this._currentDirection && util.addModifier(this, this._currentDirection);\n    }\n\n    super.attributeChangedCallback(name, last, current);\n  }\n  /**\n   * @param {String} name\n   * @param {PopoverAnimator} Animator\n   */\n\n\n  static registerAnimator(name, Animator) {\n    if (!(Animator.prototype instanceof PopoverAnimator)) {\n      util.throwAnimator('Popover');\n    }\n\n    _animatorDict[name] = Animator;\n  }\n\n  static get animators() {\n    return _animatorDict;\n  }\n\n  static get PopoverAnimator() {\n    return PopoverAnimator;\n  }\n\n}\nutil.defineBooleanProperties(PopoverElement, ['cover-target']);\nonsElements.Popover = PopoverElement;\ncustomElements.define('ons-popover', PopoverElement);","map":{"version":3,"names":["onsElements","util","autoStyle","ModifierUtil","AnimatorFactory","PopoverAnimator","IOSFadePopoverAnimator","MDFadePopoverAnimator","platform","iPhoneXPatch","BaseDialogElement","contentReady","scheme","_animatorDict","isAndroid","positions","up","left","down","right","directions","Object","keys","PopoverElement","constructor","_boundOnChange","_onChange","bind","_compile","style","display","_scheme","_mask","findChild","_popover","_content","_arrow","_updateAnimatorFactory","animators","baseClass","baseClassName","defaultAnimation","getAttribute","_toggleStyle","shouldShow","options","_currentTarget","target","_positionPopover","_clearStyles","_radius","radius","contentElement","_margin","margin","safeAreaLengths","getSafeAreaLengths","safeAreaRect","getSafeAreaDOMRect","targetRect","getBoundingClientRect","isMD","hasModifier","cover","hasAttribute","parent","findParent","document","body","parentDimensions","maxPositions","top","Math","max","bottom","min","targetDistance","targetCenterDistanceFrom","round","height","width","vertical","primary","primaryDirection","secondary","secondaryDirection","_calculateDirections","_currentDirection","addModifier","sizeName","contentSize","parseInt","getPropertyValue","window","getComputedStyle","targetAndArrowLength","primaryOffset","secondaryOffset","distance","split","map","e","sort","a","b","forEach","removeModifier","setImmediate","prepare","hasDefaultContainer","mask","createElement","classList","add","insertBefore","firstChild","arrow","appendChild","template","createFragment","content","querySelector","childNodes","setAttribute","removeAttribute","initModifier","show","Event","HTMLElement","throw","connectedCallback","addEventListener","disconnectedCallback","removeEventListener","observedAttributes","attributeChangedCallback","name","last","current","registerAnimator","Animator","prototype","throwAnimator","defineBooleanProperties","Popover","customElements","define"],"sources":["C:/React-app/ui/node_modules/onsenui/esm/elements/ons-popover.js"],"sourcesContent":["/*\nCopyright 2013-2015 ASIAL CORPORATION\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport onsElements from '../ons/elements.js';\nimport util from '../ons/util.js';\nimport autoStyle from '../ons/autostyle.js';\nimport ModifierUtil from '../ons/internal/modifier-util.js';\nimport AnimatorFactory from '../ons/internal/animator-factory.js';\nimport { PopoverAnimator, IOSFadePopoverAnimator, MDFadePopoverAnimator } from './ons-popover/animator.js';\nimport platform from '../ons/platform.js';\nimport iPhoneXPatch from '../ons/iphonex-patch.js';\nimport BaseDialogElement from './base/base-dialog.js';\nimport contentReady from '../ons/content-ready.js';\n\nconst scheme = {\n  '.popover': 'popover--*',\n  '.popover-mask': 'popover-mask--*',\n  '.popover__content': 'popover--*__content',\n  '.popover__arrow': 'popover--*__arrow'\n};\n\nconst _animatorDict = {\n  'default': function() { return platform.isAndroid() ? MDFadePopoverAnimator : IOSFadePopoverAnimator; },\n  'none': PopoverAnimator,\n  'fade-ios': IOSFadePopoverAnimator,\n  'fade-md': MDFadePopoverAnimator\n};\n\nconst positions = {\n  up: 'bottom',\n  left: 'right',\n  down: 'top',\n  right: 'left'\n};\n\nconst directions = Object.keys(positions);\n/**\n * @element ons-popover\n * @category dialog\n * @description\n *  [en]\n *    A component that displays a popover next to an element. The popover can be used to display extra information about a component or a tooltip.\n *\n *    To use the element it can either be attached directly to the `<body>` element or dynamically created from a template using the `ons.createPopover(template)` utility function and the `<template>` tag.\n *\n *    Another common way to use the popover is to display a menu when a button on the screen is tapped. For Material Design, popover looks exactly as a dropdown menu.\n *  [/en]\n *  [ja]ある要素を対象とするポップオーバーを表示するコンポーネントです。[/ja]\n * @codepen ZYYRKo\n * @tutorial vanilla/Reference/popover\n * @guide theming.html#modifiers [en]More details about the `modifier` attribute[/en][ja]modifier属性の使い方[/ja]\n * @example\n * <ons-button onclick=\"showPopover(this)\">\n *   Click me!\n * </ons-button>\n *\n * <ons-popover direction=\"down\" id=\"popover\">\n *   <p>This is a popover!</p>\n * </ons-popover>\n *\n * <script>\n *   var showPopover = function(element) {\n *     var popover = document.getElementById('popover');\n *     popover.show(element);\n *   };\n * </script>\n */\nexport default class PopoverElement extends BaseDialogElement {\n\n  /**\n   * @event preshow\n   * @description\n   *   [en]Fired just before the popover is displayed.[/en]\n   *   [ja]ポップオーバーが表示される直前に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   * @param {Function} event.cancel\n   *   [en]Call this function to stop the popover from being shown.[/en]\n   *   [ja]この関数を呼び出すと、ポップオーバーの表示がキャンセルされます。[/ja]\n   */\n\n  /**\n   * @event postshow\n   * @description\n   *   [en]Fired just after the popover is displayed.[/en]\n   *   [ja]ポップオーバーが表示された直後に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   */\n\n  /**\n   * @event prehide\n   * @description\n   *   [en]Fired just before the popover is hidden.[/en]\n   *   [ja]ポップオーバーが隠れる直前に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   * @param {Function} event.cancel\n   *   [en]Call this function to stop the popover from being hidden.[/en]\n   *   [ja]この関数を呼び出すと、ポップオーバーが隠れる処理をキャンセルします。[/ja]\n   */\n\n  /**\n   * @event posthide\n   * @description\n   *   [en]Fired just after the popover is hidden.[/en]\n   *   [ja]ポップオーバーが隠れた後に発火します。[/ja]\n   * @param {Object} event [en]Event object.[/en]\n   * @param {Object} event.popover\n   *   [en]Component object.[/en]\n   *   [ja]コンポーネントのオブジェクト。[/ja]\n   */\n\n  /**\n   * @event dialogcancel\n   * @description\n   * [en]Fired when the popover is canceled.[/en]\n   * [ja][/ja]\n   */\n\n  /**\n   * @attribute modifier\n   * @type {String}\n   * @description\n   *  [en]The appearance of the popover.[/en]\n   *  [ja]ポップオーバーの表現を指定します。[/ja]\n   */\n\n  /**\n   * @attribute direction\n   * @type {String}\n   * @description\n   *  [en]\n   *    A space separated list of directions. If more than one direction is specified,\n   *    it will be chosen automatically. Valid directions are `\"up\"`, `\"down\"`, `\"left\"` and `\"right\"`.\n   *  [/en]\n   *  [ja]\n   *    ポップオーバーを表示する方向を空白区切りで複数指定できます。\n   *    指定できる方向は、\"up\", \"down\", \"left\", \"right\"の4つです。空白区切りで複数指定することもできます。\n   *    複数指定された場合、対象とする要素に合わせて指定した値から自動的に選択されます。\n   *  [/ja]\n   */\n\n  /**\n   * @attribute cancelable\n   * @description\n   *   [en]If this attribute is set the popover can be closed by tapping the background or by pressing the back button.[/en]\n   *   [ja]この属性があると、ポップオーバーが表示された時に、背景やバックボタンをタップした時にをポップオーバー閉じます。[/ja]\n   */\n\n  /**\n   * @attribute cover-target\n   * @description\n   *   [en]If set the popover will cover the target on the screen.[/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @property coverTarget\n   * @description\n   *   [en]If set the popover will cover the target on the screen.[/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @attribute animation\n   * @type {String}\n   * @description\n   *   [en]The animation used when showing an hiding the popover. Can be either `\"none\"`, `\"default\"`, `\"fade-ios\"` or `\"fade-md\"`.[/en]\n   *   [ja]ポップオーバーを表示する際のアニメーション名を指定します。[/ja]\n   */\n\n  /**\n   * @attribute animation-options\n   * @type {Expression}\n   * @description\n   *  [en]Specify the animation's duration, timing and delay with an object literal. E.g. `{duration: 0.2, delay: 1, timing: 'ease-in'}`.[/en]\n   *  [ja]アニメーション時のduration, timing, delayをオブジェクトリテラルで指定します。e.g. {duration: 0.2, delay: 1, timing: 'ease-in'}[/ja]\n   */\n\n  /**\n   * @property animationOptions\n   * @type {Object}\n   * @description\n   *   [en]Specify the animation's duration, timing and delay with an object literal. E.g. `{duration: 0.2, delay: 1, timing: 'ease-in'}`.[/en]\n   *   [ja]アニメーション時のduration, timing, delayをオブジェクトリテラルで指定します。例：{duration: 0.2, delay: 1, timing: 'ease-in'}[/ja]\n   */\n\n  /**\n   * @attribute mask-color\n   * @type {Color}\n   * @description\n   *   [en]Color of the background mask. Default is `\"rgba(0, 0, 0, 0.2)\"`.[/en]\n   *   [ja]背景のマスクの色を指定します。デフォルトは\"rgba(0, 0, 0, 0.2)\"です。[/ja]\n   */\n\n  /**\n   * @attribute visible\n   * @type {Boolean}\n   * @description\n   *   [en]Whether the popover is visible or not.[/en]\n   *   [ja]要素が見える場合に`true`。[/ja]\n   */\n\n  constructor() {\n    super();\n\n    this._boundOnChange = this._onChange.bind(this);\n\n    contentReady(this, () => {\n      this._compile();\n      this.style.display = 'none';\n    });\n  }\n\n  get _scheme() {\n    return scheme;\n  }\n\n  get _mask() {\n    return util.findChild(this, '.popover-mask');\n  }\n\n  get _popover() {\n    return util.findChild(this, '.popover');\n  }\n\n  get _content() {\n    return util.findChild(this._popover, '.popover__content');\n  }\n\n  get _arrow() {\n    return util.findChild(this._popover, '.popover__arrow');\n  }\n\n  _updateAnimatorFactory() {\n    return new AnimatorFactory({\n      animators: _animatorDict,\n      baseClass: PopoverAnimator,\n      baseClassName: 'PopoverAnimator',\n      defaultAnimation: this.getAttribute('animation') || 'default'\n    });\n  }\n\n  _toggleStyle(shouldShow, options = {}) {\n    if (shouldShow) {\n      this.style.display = 'block';\n      this._currentTarget = options.target;\n      this._positionPopover(options.target);\n    } else {\n      this.style.display = 'none';\n      this._clearStyles();\n    }\n  }\n\n  _positionPopover(target) {\n    const {_radius: radius, _content: contentElement, _margin: margin} = this;\n    const safeAreaLengths = iPhoneXPatch.getSafeAreaLengths();\n    const safeAreaRect = iPhoneXPatch.getSafeAreaDOMRect();\n    const targetRect = target.getBoundingClientRect();\n    const isMD = util.hasModifier(this, 'material');\n    const cover = isMD && this.hasAttribute('cover-target');\n    const parent = util.findParent(this, 'ons-page') || document.body;\n    const parentDimensions = parent.getBoundingClientRect();\n    const maxPositions = {\n      top: Math.max(parentDimensions.top, safeAreaRect.top),\n      left: Math.max(parentDimensions.left, safeAreaRect.left),\n      bottom: Math.min(parentDimensions.bottom, safeAreaRect.bottom),\n      right: Math.min(parentDimensions.right, safeAreaRect.right),\n    };\n\n    // Distance from each side of the safe area (with margin) to the target element\n    const targetDistance = {\n      top: targetRect.top - (maxPositions.top + margin),\n      left: targetRect.left - (maxPositions.left + margin),\n      bottom: (maxPositions.bottom - margin) - targetRect.bottom,\n      right: (maxPositions.right - margin) - targetRect.right\n    };\n\n    // Distance from each side of the safe area (with margin) to the geometric center of the target element\n    const targetCenterDistanceFrom = {\n      top: targetRect.top + Math.round(targetRect.height / 2) - (maxPositions.top + margin),\n      left: targetRect.left + Math.round(targetRect.width / 2) - (maxPositions.left + margin),\n      bottom: (maxPositions.bottom - margin) - targetRect.bottom + Math.round(targetRect.height / 2),\n      right: (maxPositions.right - margin) - targetRect.right + Math.round(targetRect.width / 2)\n    };\n\n    const {vertical, primary: primaryDirection, secondary: secondaryDirection} = this._calculateDirections(targetDistance);\n    this._currentDirection = primaryDirection;\n    util.addModifier(this, primaryDirection);\n\n    const sizeName = vertical ? 'width' : 'height';\n    // Get .popover__content size\n    const contentSize = (style => ({\n      width: parseInt(style.getPropertyValue('width'), 10),\n      height: parseInt(style.getPropertyValue('height'), 10)\n    }))(window.getComputedStyle(contentElement));\n\n    // Setting .popover position.\n    const targetAndArrowLength = cover ? 0 : (vertical ? targetRect.height : targetRect.width) + (isMD ? 0 : 14);\n    const primaryOffset = Math.max(\n      safeAreaLengths[primaryDirection] + margin,\n      safeAreaLengths[primaryDirection] + margin + targetDistance[primaryDirection] + targetAndArrowLength\n    );\n    const secondaryOffset = Math.max(\n      safeAreaLengths[secondaryDirection] + margin,\n      safeAreaLengths[secondaryDirection] + margin + targetCenterDistanceFrom[secondaryDirection] - (contentSize[sizeName] / 2)\n    );\n    this._popover.style[primaryDirection] = primaryOffset + 'px';\n    this._popover.style[secondaryDirection] = secondaryOffset + 'px';\n\n    // Setting .popover__arrow position.\n    this._arrow.style[secondaryDirection] = Math.max(\n      radius,\n      (safeAreaLengths[secondaryDirection] + margin) + targetCenterDistanceFrom[secondaryDirection] - secondaryOffset\n    ) + 'px';\n  }\n\n  _calculateDirections(distance) {\n    const options = (this.getAttribute('direction') || 'up down left right').split(/\\s+/).map(e => positions[e]);\n    const primary = options.sort((a, b) => distance[a] - distance[b])[0];\n    const vertical = 'top' == primary || 'bottom' == primary;\n    let secondary;\n\n    if (vertical) {\n      secondary = distance.left < distance.right ? 'left' : 'right';\n    } else {\n      secondary = distance.top < distance.bottom ? 'top' : 'bottom';\n    }\n\n    return {vertical, primary, secondary};\n  }\n\n  _clearStyles() {\n    this._currentDirection = null;\n    ['top', 'bottom', 'left', 'right'].forEach(e => {\n      this._arrow.style[e] = this._content.style[e] = this._popover.style[e] = '';\n      util.removeModifier(this, e);\n    });\n  }\n\n  _onChange() {\n    setImmediate(() => {\n      if (this._currentTarget) {\n        this._positionPopover(this._currentTarget);\n      }\n    });\n  }\n\n  _compile() {\n    autoStyle.prepare(this);\n\n    if (this._popover && this._mask) {\n      return;\n    }\n\n    const hasDefaultContainer = this._popover && this._content;\n\n    if (hasDefaultContainer) {\n\n      if (!this._mask) {\n        const mask = document.createElement('div');\n        mask.classList.add('popover-mask');\n        this.insertBefore(mask, this.firstChild);\n      }\n\n      if (!this._arrow) {\n        const arrow = document.createElement('div');\n        arrow.classList.add('popover__arrow');\n        this._popover.appendChild(arrow);\n      }\n\n    } else {\n\n      const template = util.createFragment(`\n        <div class=\"popover-mask\"></div>\n        <div class=\"popover\">\n          <div class=\"popover__content\"></div>\n          <div class=\"popover__arrow\"></div>\n        </div>\n      `);\n      const content = template.querySelector('.popover__content');\n\n      while (this.childNodes[0]) {\n        content.appendChild(this.childNodes[0]);\n      }\n\n      this.appendChild(template);\n    }\n\n    // FIXME!\n    if (this.hasAttribute('style')) {\n      this._popover.setAttribute('style', this.getAttribute('style'));\n      this.removeAttribute('style');\n    }\n\n    ModifierUtil.initModifier(this, this._scheme);\n  }\n\n  /**\n   * @method show\n   * @signature show(target, [options])\n   * @param {String|Event|HTMLElement} target\n   *   [en]Target element. Can be either a CSS selector, an event object or a DOM element. It can be also provided as 'options.target' instead. [/en]\n   *   [ja]ポップオーバーのターゲットとなる要素を指定します。CSSセレクタかeventオブジェクトかDOM要素のいずれかを渡せます。[/ja]\n   * @param {Object} [options]\n   *   [en]Parameter object.[/en]\n   *   [ja]オプションを指定するオブジェクト。[/ja]\n   * @param {String} [options.animation]\n   *   [en]Animation name.  Use one of `\"fade-ios\"`, `\"fade-md\"`, `\"none\"` and `\"default\"`.[/en]\n   *   [ja]アニメーション名を指定します。\"fade-ios\", \"fade-md\", \"none\", \"default\"のいずれかを指定できます。[/ja]\n   * @param {String} [options.animationOptions]\n   *   [en]Specify the animation's duration, delay and timing. E.g. `{duration: 0.2, delay: 0.4, timing: 'ease-in'}`.[/en]\n   *   [ja]アニメーション時のduration, delay, timingを指定します。e.g. {duration: 0.2, delay: 0.4, timing: 'ease-in'}[/ja]\n   * @param {Function} [options.callback]\n   *   [en]This function is called after the popover has been revealed.[/en]\n   *   [ja]ポップオーバーが表示され終わった後に呼び出される関数オブジェクトを指定します。[/ja]\n   * @description\n   *   [en]Open the popover and point it at a target. The target can be either an event, a CSS selector or a DOM element..[/en]\n   *   [ja]対象とする要素にポップオーバーを表示します。target引数には、$eventオブジェクトやDOMエレメントやCSSセレクタを渡すことが出来ます。[/ja]\n   * @return {Promise}\n   *   [en]Resolves to the displayed element[/en]\n   *   [ja][/ja]\n   */\n  show(target, options = {}) {\n    // Copy options and include options.target\n    if (target && typeof target === 'object' && !(target instanceof Event) && !(target instanceof HTMLElement)) {\n      options = { ...target };\n    } else {\n      options = { ...options, target };\n    }\n\n    if (typeof options.target === 'string') {\n      options.target = document.querySelector(options.target);\n    } else if (options.target instanceof Event) {\n      options.target = options.target.target;\n    }\n\n    if (!(options.target instanceof HTMLElement)) {\n     util.throw('Invalid target type or undefined');\n    }\n\n    return super.show(options);\n  }\n\n  /**\n   * @method hide\n   * @signature hide([options])\n   * @param {Object} [options]\n   *   [en]Parameter object.[/en]\n   *   [ja]オプションを指定するオブジェクト。[/ja]\n   * @param {String} [options.animation]\n   *   [en]Animation name.  Use one of `\"fade-ios\"`, `\"fade-md\"`, `\"none\"` and `\"default\"`.[/en]\n   *   [ja]アニメーション名を指定します。\"fade-ios\", \"fade-md\", \"none\", \"default\"のいずれかを指定できます。[/ja]\n   * @param {String} [options.animationOptions]\n   *   [en]Specify the animation's duration, delay and timing. E.g. `{duration: 0.2, delay: 0.4, timing: 'ease-in'}`.[/en]\n   *   [ja]アニメーション時のduration, delay, timingを指定します。e.g. {duration: 0.2, delay: 0.4, timing: 'ease-in'}[/ja]\n   * @param {Function} [options.callback]\n   *   [en]This functions is called after the popover has been hidden.[/en]\n   *   [ja]ポップオーバーが隠れた後に呼び出される関数オブジェクトを指定します。[/ja]\n   * @description\n   *   [en]Close the popover.[/en]\n   *   [ja]ポップオーバーを閉じます。[/ja]\n   * @return {Promise}\n   *   [en]Resolves to the hidden element[/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @property visible\n   * @type {Boolean}\n   * @description\n   *   [en]Whether the element is visible or not.[/en]\n   *   [ja]要素が見える場合に`true`。[/ja]\n   */\n\n  /**\n   * @property cancelable\n   * @type {Boolean}\n   * @description\n   *   [en]\n   *     A boolean value that specifies whether the popover is cancelable or not.\n   *\n   *     When the popover is cancelable it can be closed by tapping the background or by pressing the back button on Android devices.\n   *   [/en]\n   *   [ja][/ja]\n   */\n\n  /**\n   * @property onDeviceBackButton\n   * @type {Object}\n   * @description\n   *   [en]Back-button handler.[/en]\n   *   [ja]バックボタンハンドラ。[/ja]\n   */\n\n  /**\n   * @property maskColor\n   * @type {String}\n   * @default rgba(0, 0, 0, 0.2)\n   * @description\n   *  [en]Color of the background mask. Default is \"rgba(0, 0, 0, 0.2)\".[/en]\n   *  [ja]背景のマスクの色を指定します。\"rgba(0, 0, 0, 0.2)\"がデフォルト値です。[/ja]\n   */\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    window.addEventListener('resize', this._boundOnChange, false);\n    this._margin = this._margin || parseInt(window.getComputedStyle(this).getPropertyValue('top'));\n    this._margin = this._margin || 6; // Fix for iframes\n\n    contentReady(this, () => {\n      this._radius = parseInt(window.getComputedStyle(this._content).getPropertyValue('border-top-left-radius'));\n    });\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    window.removeEventListener('resize', this._boundOnChange, false);\n  }\n\n  static get observedAttributes() {\n    return [...super.observedAttributes, 'direction'];\n  }\n\n  attributeChangedCallback(name, last, current) {\n    if (name === 'direction') {\n      return this._boundOnChange();\n    } else if (name === 'modifier') {\n      this._currentDirection && util.addModifier(this, this._currentDirection);\n    }\n    super.attributeChangedCallback(name, last, current);\n  }\n\n  /**\n   * @param {String} name\n   * @param {PopoverAnimator} Animator\n   */\n  static registerAnimator(name, Animator) {\n    if (!(Animator.prototype instanceof PopoverAnimator)) {\n      util.throwAnimator('Popover');\n    }\n    _animatorDict[name] = Animator;\n  }\n\n  static get animators() {\n    return _animatorDict;\n  }\n\n  static get PopoverAnimator() {\n    return PopoverAnimator;\n  }\n}\n\nutil.defineBooleanProperties(PopoverElement, ['cover-target']);\n\nonsElements.Popover = PopoverElement;\ncustomElements.define('ons-popover', PopoverElement);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}