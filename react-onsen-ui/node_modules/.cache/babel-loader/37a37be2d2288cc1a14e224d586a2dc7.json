{"ast":null,"code":"/*\nCopyright 2013-2015 ASIAL CORPORATION\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\nimport util from '../util.js';\nimport platform from '../platform.js';\nexport class LazyRepeatDelegate {\n  constructor(userDelegate) {\n    let templateElement = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n    if (typeof userDelegate !== 'object' || userDelegate === null) {\n      util.throw('\"delegate\" parameter must be an object');\n    }\n\n    this._userDelegate = userDelegate;\n\n    if (!(templateElement instanceof Element) && templateElement !== null) {\n      util.throw('\"templateElement\" parameter must be an instance of Element or null');\n    }\n\n    this._templateElement = templateElement;\n  }\n\n  get itemHeight() {\n    return this._userDelegate.itemHeight;\n  }\n  /**\n   * @return {Boolean}\n   */\n\n\n  hasRenderFunction() {\n    return this._userDelegate._render instanceof Function;\n  }\n  /**\n   * @return {void}\n   */\n\n\n  _render() {\n    this._userDelegate._render.apply(this._userDelegate, arguments);\n  }\n  /**\n   * @param {Number} index\n   * @param {Function} done A function that take item object as parameter.\n   */\n\n\n  loadItemElement(index, done) {\n    if (this._userDelegate.loadItemElement instanceof Function) {\n      this._userDelegate.loadItemElement(index, done);\n    } else {\n      const element = this._userDelegate.createItemContent(index, this._templateElement);\n\n      if (!(element instanceof Element)) {\n        util.throw('\"createItemContent\" must return an instance of Element');\n      }\n\n      done({\n        element\n      });\n    }\n  }\n  /**\n   * @return {Number}\n   */\n\n\n  countItems() {\n    const count = this._userDelegate.countItems();\n\n    if (typeof count !== 'number') {\n      util.throw('\"countItems\" must return a number');\n    }\n\n    return count;\n  }\n  /**\n   * @param {Number} index\n   * @param {Object} item\n   * @param {Element} item.element\n   */\n\n\n  updateItem(index, item) {\n    if (this._userDelegate.updateItemContent instanceof Function) {\n      this._userDelegate.updateItemContent(index, item);\n    }\n  }\n  /**\n   * @return {Number}\n   */\n\n\n  calculateItemHeight(index) {\n    if (this._userDelegate.calculateItemHeight instanceof Function) {\n      const height = this._userDelegate.calculateItemHeight(index);\n\n      if (typeof height !== 'number') {\n        util.throw('\"calculateItemHeight\" must return a number');\n      }\n\n      return height;\n    }\n\n    return 0;\n  }\n  /**\n   * @param {Number} index\n   * @param {Object} item\n   */\n\n\n  destroyItem(index, item) {\n    if (this._userDelegate.destroyItem instanceof Function) {\n      this._userDelegate.destroyItem(index, item);\n    }\n  }\n  /**\n   * @return {void}\n   */\n\n\n  destroy() {\n    if (this._userDelegate.destroy instanceof Function) {\n      this._userDelegate.destroy();\n    }\n\n    this._userDelegate = this._templateElement = null;\n  }\n\n}\n/**\n * This class provide core functions for ons-lazy-repeat.\n */\n\nexport class LazyRepeatProvider {\n  /**\n   * @param {Element} wrapperElement\n   * @param {LazyRepeatDelegate} delegate\n   */\n  constructor(wrapperElement, delegate) {\n    if (!(delegate instanceof LazyRepeatDelegate)) {\n      util.throw('\"delegate\" parameter must be an instance of LazyRepeatDelegate');\n    }\n\n    this._wrapperElement = wrapperElement;\n    this._delegate = delegate;\n    this._insertIndex = this._wrapperElement.children[0] && this._wrapperElement.children[0].tagName === 'ONS-LAZY-REPEAT' ? 1 : 0;\n\n    if (wrapperElement.tagName.toLowerCase() === 'ons-list') {\n      wrapperElement.classList.add('lazy-list');\n    }\n\n    this._pageContent = this._findPageContentElement(wrapperElement);\n\n    if (!this._pageContent) {\n      util.throw('LazyRepeat must be descendant of a Page element');\n    }\n\n    this.lastScrollTop = this._pageContent.scrollTop;\n    this.padding = 0;\n    this._topPositions = [0];\n    this._renderedItems = {};\n\n    if (!this._delegate.itemHeight && !this._delegate.calculateItemHeight(0)) {\n      this._unknownItemHeight = true;\n    }\n\n    this._addEventListeners();\n\n    this._onChange();\n  }\n\n  get padding() {\n    return parseInt(this._wrapperElement.style.paddingTop, 10);\n  }\n\n  set padding(newValue) {\n    this._wrapperElement.style.paddingTop = newValue + 'px';\n  }\n\n  _findPageContentElement(wrapperElement) {\n    const pageContent = util.findParent(wrapperElement, '.page__content');\n\n    if (pageContent) {\n      return pageContent;\n    }\n\n    const page = util.findParent(wrapperElement, 'ons-page');\n\n    if (page) {\n      const content = util.findChild(page, '.content');\n\n      if (content) {\n        return content;\n      }\n    }\n\n    return null;\n  }\n\n  _checkItemHeight(callback) {\n    this._delegate.loadItemElement(0, item => {\n      if (!this._unknownItemHeight) {\n        util.throw('Invalid state');\n      }\n\n      this._wrapperElement.appendChild(item.element);\n\n      const done = () => {\n        this._delegate.destroyItem(0, item);\n\n        item.element && item.element.remove();\n        delete this._unknownItemHeight;\n        callback();\n      };\n\n      this._itemHeight = item.element.offsetHeight;\n\n      if (this._itemHeight > 0) {\n        done();\n        return;\n      } // retry to measure offset height\n      // dirty fix for angular2 directive\n\n\n      this._wrapperElement.style.visibility = 'hidden';\n      item.element.style.visibility = 'hidden';\n      setImmediate(() => {\n        this._itemHeight = item.element.offsetHeight;\n\n        if (this._itemHeight == 0) {\n          util.throw('Invalid state: \"itemHeight\" must be greater than zero');\n        }\n\n        this._wrapperElement.style.visibility = '';\n        done();\n      });\n    });\n  }\n\n  get staticItemHeight() {\n    return this._delegate.itemHeight || this._itemHeight;\n  }\n\n  _countItems() {\n    return this._delegate.countItems();\n  }\n\n  _getItemHeight(i) {\n    // Item is rendered\n    if (Object.prototype.hasOwnProperty.call(this._renderedItems, i)) {\n      if (!Object.prototype.hasOwnProperty.call(this._renderedItems[i], 'height')) {\n        this._renderedItems[i].height = this._renderedItems[i].element.offsetHeight;\n      }\n\n      return this._renderedItems[i].height;\n    } // Item is not rendered, scroll up\n\n\n    if (this._topPositions[i + 1] && this._topPositions[i]) {\n      return this._topPositions[i + 1] - this._topPositions[i];\n    } // Item is not rendered, scroll down\n\n\n    return this.staticItemHeight || this._delegate.calculateItemHeight(i);\n  }\n\n  _calculateRenderedHeight() {\n    return Object.keys(this._renderedItems).reduce((a, b) => a + this._getItemHeight(+b), 0);\n  }\n\n  _onChange() {\n    this._render();\n  }\n\n  _lastItemRendered() {\n    return Math.max(...Object.keys(this._renderedItems));\n  }\n\n  _firstItemRendered() {\n    return Math.min(...Object.keys(this._renderedItems));\n  }\n\n  refresh() {\n    const forceRender = {\n      forceScrollDown: true\n    };\n\n    const firstItemIndex = this._firstItemRendered();\n\n    if (util.isInteger(firstItemIndex)) {\n      this._wrapperElement.style.height = this._topPositions[firstItemIndex] + this._calculateRenderedHeight() + 'px';\n      this.padding = this._topPositions[firstItemIndex];\n      forceRender.forceFirstIndex = firstItemIndex;\n    }\n\n    this._removeAllElements();\n\n    this._render(forceRender);\n\n    this._wrapperElement.style.height = 'inherit';\n  }\n\n  _render() {\n    let {\n      forceScrollDown = false,\n      forceFirstIndex,\n      forceLastIndex\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (this._unknownItemHeight) {\n      return this._checkItemHeight(this._render.bind(this, arguments[0]));\n    }\n\n    const isScrollUp = !forceScrollDown && this.lastScrollTop > this._pageContent.scrollTop;\n    this.lastScrollTop = this._pageContent.scrollTop;\n    const keep = {};\n\n    const offset = this._wrapperElement.getBoundingClientRect().top;\n\n    const limit = 4 * window.innerHeight - offset;\n\n    const count = this._countItems();\n\n    const items = [];\n    const start = forceFirstIndex || Math.max(0, this._calculateStartIndex(offset) - 30); // Recalculate for 0 or undefined\n\n    let i = start;\n\n    for (let top = this._topPositions[i]; i < count && top < limit; i++) {\n      if (i >= this._topPositions.length) {\n        // perf optimization\n        this._topPositions.length += 100;\n      }\n\n      this._topPositions[i] = top;\n      top += this._getItemHeight(i);\n    }\n\n    if (this._delegate.hasRenderFunction && this._delegate.hasRenderFunction()) {\n      return this._delegate._render(start, i, () => {\n        this.padding = this._topPositions[start];\n      });\n    }\n\n    if (isScrollUp) {\n      for (let j = i - 1; j >= start; j--) {\n        keep[j] = true;\n\n        this._renderElement(j, isScrollUp);\n      }\n    } else {\n      const lastIndex = forceLastIndex || Math.max(i - 1, ...Object.keys(this._renderedItems)); // Recalculate for 0 or undefined\n\n      for (let j = start; j <= lastIndex; j++) {\n        keep[j] = true;\n\n        this._renderElement(j, isScrollUp);\n      }\n    }\n\n    Object.keys(this._renderedItems).forEach(key => keep[key] || this._removeElement(key, isScrollUp));\n  }\n  /**\n   * @param {Number} index\n   * @param {Boolean} isScrollUp\n   */\n\n\n  _renderElement(index, isScrollUp) {\n    const item = this._renderedItems[index];\n\n    if (item) {\n      this._delegate.updateItem(index, item); // update if it exists\n\n\n      return;\n    }\n\n    this._delegate.loadItemElement(index, item => {\n      if (isScrollUp) {\n        this._wrapperElement.insertBefore(item.element, this._wrapperElement.children[this._insertIndex]);\n\n        this.padding = this._topPositions[index];\n        item.height = this._topPositions[index + 1] - this._topPositions[index];\n      } else {\n        this._wrapperElement.appendChild(item.element);\n      }\n\n      this._renderedItems[index] = item;\n    });\n  }\n  /**\n   * @param {Number} index\n   * @param {Boolean} isScrollUp\n   */\n\n\n  _removeElement(index) {\n    let isScrollUp = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    index = +index;\n    const item = this._renderedItems[index];\n\n    this._delegate.destroyItem(index, item);\n\n    if (isScrollUp) {\n      this._topPositions[index + 1] = undefined;\n    } else {\n      this.padding = this.padding + this._getItemHeight(index);\n    }\n\n    if (item.element.parentElement) {\n      item.element.parentElement.removeChild(item.element);\n    }\n\n    delete this._renderedItems[index];\n  }\n\n  _removeAllElements() {\n    Object.keys(this._renderedItems).forEach(key => this._removeElement(key));\n  }\n\n  _recalculateTopPositions(start, end) {\n    for (let i = start; i <= end; i++) {\n      this._topPositions[i + 1] = this._topPositions[i] + this._getItemHeight(i);\n    }\n  }\n\n  _calculateStartIndex(current) {\n    const firstItemIndex = this._firstItemRendered();\n\n    const lastItemIndex = this._lastItemRendered(); // Fix for Safari scroll and Angular 2\n\n\n    this._recalculateTopPositions(firstItemIndex, lastItemIndex);\n\n    let start = 0;\n    let end = this._countItems() - 1; // Binary search for index at top of screen so we can speed up rendering.\n\n    for (;;) {\n      const middle = Math.floor((start + end) / 2);\n      const value = current + this._topPositions[middle];\n\n      if (end < start) {\n        return 0;\n      } else if (value <= 0 && value + this._getItemHeight(middle) > 0) {\n        return middle;\n      } else if (isNaN(value) || value >= 0) {\n        end = middle - 1;\n      } else {\n        start = middle + 1;\n      }\n    }\n  }\n\n  _debounce(func, wait, immediate) {\n    let timeout;\n    return function () {\n      const callNow = immediate && !timeout;\n      clearTimeout(timeout);\n\n      if (callNow) {\n        func.apply(this, arguments);\n      } else {\n        timeout = setTimeout(() => {\n          timeout = null;\n          func.apply(this, arguments);\n        }, wait);\n      }\n    };\n  }\n\n  _doubleFireOnTouchend() {\n    this._render();\n\n    this._debounce(this._render.bind(this), 100);\n  }\n\n  _addEventListeners() {\n    util.bindListeners(this, ['_onChange', '_doubleFireOnTouchend']);\n\n    if (platform.isIOS()) {\n      this._boundOnChange = this._debounce(this._boundOnChange, 30);\n    }\n\n    this._pageContent.addEventListener('scroll', this._boundOnChange, true);\n\n    if (platform.isIOS()) {\n      util.addEventListener(this._pageContent, 'touchmove', this._boundOnChange, {\n        capture: true,\n        passive: true\n      });\n\n      this._pageContent.addEventListener('touchend', this._boundDoubleFireOnTouchend, true);\n    }\n\n    window.document.addEventListener('resize', this._boundOnChange, true);\n  }\n\n  _removeEventListeners() {\n    this._pageContent.removeEventListener('scroll', this._boundOnChange, true);\n\n    if (platform.isIOS()) {\n      util.removeEventListener(this._pageContent, 'touchmove', this._boundOnChange, {\n        capture: true,\n        passive: true\n      });\n\n      this._pageContent.removeEventListener('touchend', this._boundDoubleFireOnTouchend, true);\n    }\n\n    window.document.removeEventListener('resize', this._boundOnChange, true);\n  }\n\n  destroy() {\n    this._removeAllElements();\n\n    this._delegate.destroy();\n\n    this._parentElement = this._delegate = this._renderedItems = null;\n\n    this._removeEventListeners();\n  }\n\n}","map":{"version":3,"names":["util","platform","LazyRepeatDelegate","constructor","userDelegate","templateElement","throw","_userDelegate","Element","_templateElement","itemHeight","hasRenderFunction","_render","Function","apply","arguments","loadItemElement","index","done","element","createItemContent","countItems","count","updateItem","item","updateItemContent","calculateItemHeight","height","destroyItem","destroy","LazyRepeatProvider","wrapperElement","delegate","_wrapperElement","_delegate","_insertIndex","children","tagName","toLowerCase","classList","add","_pageContent","_findPageContentElement","lastScrollTop","scrollTop","padding","_topPositions","_renderedItems","_unknownItemHeight","_addEventListeners","_onChange","parseInt","style","paddingTop","newValue","pageContent","findParent","page","content","findChild","_checkItemHeight","callback","appendChild","remove","_itemHeight","offsetHeight","visibility","setImmediate","staticItemHeight","_countItems","_getItemHeight","i","Object","prototype","hasOwnProperty","call","_calculateRenderedHeight","keys","reduce","a","b","_lastItemRendered","Math","max","_firstItemRendered","min","refresh","forceRender","forceScrollDown","firstItemIndex","isInteger","forceFirstIndex","_removeAllElements","forceLastIndex","bind","isScrollUp","keep","offset","getBoundingClientRect","top","limit","window","innerHeight","items","start","_calculateStartIndex","length","j","_renderElement","lastIndex","forEach","key","_removeElement","insertBefore","undefined","parentElement","removeChild","_recalculateTopPositions","end","current","lastItemIndex","middle","floor","value","isNaN","_debounce","func","wait","immediate","timeout","callNow","clearTimeout","setTimeout","_doubleFireOnTouchend","bindListeners","isIOS","_boundOnChange","addEventListener","capture","passive","_boundDoubleFireOnTouchend","document","_removeEventListeners","removeEventListener","_parentElement"],"sources":["C:/React-app/test/ui/node_modules/onsenui/esm/ons/internal/lazy-repeat.js"],"sourcesContent":["/*\nCopyright 2013-2015 ASIAL CORPORATION\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport util from '../util.js';\nimport platform from '../platform.js';\n\nexport class LazyRepeatDelegate {\n\n  constructor(userDelegate, templateElement = null) {\n    if (typeof userDelegate !== 'object' || userDelegate === null) {\n      util.throw('\"delegate\" parameter must be an object');\n    }\n    this._userDelegate = userDelegate;\n\n    if (!(templateElement instanceof Element) && templateElement !== null) {\n      util.throw('\"templateElement\" parameter must be an instance of Element or null');\n    }\n    this._templateElement = templateElement;\n  }\n\n  get itemHeight() {\n    return this._userDelegate.itemHeight;\n  }\n\n  /**\n   * @return {Boolean}\n   */\n  hasRenderFunction() {\n    return this._userDelegate._render instanceof Function;\n  }\n\n  /**\n   * @return {void}\n   */\n  _render() {\n    this._userDelegate._render.apply(this._userDelegate, arguments);\n  }\n\n  /**\n   * @param {Number} index\n   * @param {Function} done A function that take item object as parameter.\n   */\n  loadItemElement(index, done) {\n    if (this._userDelegate.loadItemElement instanceof Function) {\n      this._userDelegate.loadItemElement(index, done);\n    } else {\n      const element = this._userDelegate.createItemContent(index, this._templateElement);\n      if (!(element instanceof Element)) {\n        util.throw('\"createItemContent\" must return an instance of Element');\n      }\n\n      done({element});\n    }\n  }\n\n  /**\n   * @return {Number}\n   */\n  countItems() {\n    const count = this._userDelegate.countItems();\n    if (typeof count !== 'number') {\n      util.throw('\"countItems\" must return a number');\n    }\n    return count;\n  }\n\n  /**\n   * @param {Number} index\n   * @param {Object} item\n   * @param {Element} item.element\n   */\n  updateItem(index, item) {\n    if (this._userDelegate.updateItemContent instanceof Function) {\n      this._userDelegate.updateItemContent(index, item);\n    }\n  }\n\n  /**\n   * @return {Number}\n   */\n  calculateItemHeight(index) {\n    if (this._userDelegate.calculateItemHeight instanceof Function) {\n      const height = this._userDelegate.calculateItemHeight(index);\n\n      if (typeof height !== 'number') {\n        util.throw('\"calculateItemHeight\" must return a number');\n      }\n\n      return height;\n    }\n\n    return 0;\n  }\n\n  /**\n   * @param {Number} index\n   * @param {Object} item\n   */\n  destroyItem(index, item) {\n    if (this._userDelegate.destroyItem instanceof Function) {\n      this._userDelegate.destroyItem(index, item);\n    }\n  }\n\n  /**\n   * @return {void}\n   */\n  destroy() {\n    if (this._userDelegate.destroy instanceof Function) {\n      this._userDelegate.destroy();\n    }\n\n    this._userDelegate = this._templateElement = null;\n  }\n}\n\n/**\n * This class provide core functions for ons-lazy-repeat.\n */\nexport class LazyRepeatProvider {\n\n  /**\n   * @param {Element} wrapperElement\n   * @param {LazyRepeatDelegate} delegate\n   */\n  constructor(wrapperElement, delegate) {\n    if (!(delegate instanceof LazyRepeatDelegate)) {\n      util.throw('\"delegate\" parameter must be an instance of LazyRepeatDelegate');\n    }\n\n    this._wrapperElement = wrapperElement;\n    this._delegate = delegate;\n    this._insertIndex = (this._wrapperElement.children[0] && this._wrapperElement.children[0].tagName === 'ONS-LAZY-REPEAT') ? 1 : 0;\n\n    if (wrapperElement.tagName.toLowerCase() === 'ons-list') {\n      wrapperElement.classList.add('lazy-list');\n    }\n\n    this._pageContent = this._findPageContentElement(wrapperElement);\n\n    if (!this._pageContent) {\n      util.throw('LazyRepeat must be descendant of a Page element');\n    }\n\n    this.lastScrollTop = this._pageContent.scrollTop;\n    this.padding = 0;\n    this._topPositions = [0];\n    this._renderedItems = {};\n\n    if (!this._delegate.itemHeight && !this._delegate.calculateItemHeight(0)) {\n      this._unknownItemHeight = true;\n    }\n\n    this._addEventListeners();\n    this._onChange();\n  }\n\n  get padding() {\n    return parseInt(this._wrapperElement.style.paddingTop, 10);\n  }\n\n  set padding(newValue) {\n    this._wrapperElement.style.paddingTop = newValue + 'px';\n  }\n\n  _findPageContentElement(wrapperElement) {\n    const pageContent = util.findParent(wrapperElement, '.page__content');\n\n    if (pageContent) {\n      return pageContent;\n    }\n\n    const page = util.findParent(wrapperElement, 'ons-page');\n    if (page) {\n      const content = util.findChild(page, '.content');\n      if (content) {\n        return content;\n      }\n    }\n\n    return null;\n  }\n\n  _checkItemHeight(callback) {\n    this._delegate.loadItemElement(0, item => {\n      if (!this._unknownItemHeight) {\n        util.throw('Invalid state');\n      }\n\n      this._wrapperElement.appendChild(item.element);\n\n      const done = () => {\n        this._delegate.destroyItem(0, item);\n        item.element && item.element.remove();\n        delete this._unknownItemHeight;\n        callback();\n      };\n\n      this._itemHeight = item.element.offsetHeight;\n\n      if (this._itemHeight > 0) {\n        done();\n        return;\n      }\n\n      // retry to measure offset height\n      // dirty fix for angular2 directive\n      this._wrapperElement.style.visibility = 'hidden';\n      item.element.style.visibility = 'hidden';\n\n      setImmediate(() => {\n        this._itemHeight = item.element.offsetHeight;\n        if (this._itemHeight == 0) {\n          util.throw('Invalid state: \"itemHeight\" must be greater than zero');\n        }\n        this._wrapperElement.style.visibility = '';\n        done();\n      });\n    });\n  }\n\n  get staticItemHeight() {\n    return this._delegate.itemHeight || this._itemHeight;\n  }\n  _countItems() {\n    return this._delegate.countItems();\n  }\n\n  _getItemHeight(i) {\n    // Item is rendered\n    if (Object.prototype.hasOwnProperty.call(this._renderedItems, i)) {\n      if (!Object.prototype.hasOwnProperty.call(this._renderedItems[i], 'height')) {\n        this._renderedItems[i].height = this._renderedItems[i].element.offsetHeight;\n      }\n      return this._renderedItems[i].height;\n    }\n\n    // Item is not rendered, scroll up\n    if (this._topPositions[i + 1] && this._topPositions[i]) {\n      return this._topPositions[i + 1] - this._topPositions[i];\n    }\n    // Item is not rendered, scroll down\n    return this.staticItemHeight || this._delegate.calculateItemHeight(i);\n  }\n\n  _calculateRenderedHeight() {\n    return Object.keys(this._renderedItems).reduce((a, b) => a + this._getItemHeight(+(b)), 0);\n  }\n\n  _onChange() {\n    this._render();\n  }\n\n  _lastItemRendered() {\n    return Math.max(...Object.keys(this._renderedItems));\n  }\n\n  _firstItemRendered() {\n    return Math.min(...Object.keys(this._renderedItems));\n  }\n\n  refresh() {\n    const forceRender = { forceScrollDown: true };\n    const firstItemIndex = this._firstItemRendered();\n\n    if (util.isInteger(firstItemIndex)) {\n      this._wrapperElement.style.height = this._topPositions[firstItemIndex] + this._calculateRenderedHeight() + 'px';\n      this.padding = this._topPositions[firstItemIndex];\n      forceRender.forceFirstIndex = firstItemIndex;\n    }\n\n    this._removeAllElements();\n    this._render(forceRender);\n    this._wrapperElement.style.height = 'inherit';\n  }\n\n  _render({forceScrollDown = false, forceFirstIndex, forceLastIndex} = {}) {\n    if (this._unknownItemHeight) {\n      return this._checkItemHeight(this._render.bind(this, arguments[0]));\n    }\n\n    const isScrollUp = !forceScrollDown && this.lastScrollTop > this._pageContent.scrollTop;\n    this.lastScrollTop = this._pageContent.scrollTop;\n    const keep = {};\n\n    const offset = this._wrapperElement.getBoundingClientRect().top;\n    const limit = 4 * window.innerHeight - offset;\n    const count = this._countItems();\n\n    const items = [];\n    const start = forceFirstIndex || Math.max(0, this._calculateStartIndex(offset) - 30); // Recalculate for 0 or undefined\n    let i = start;\n\n    for (let top = this._topPositions[i]; i < count && top < limit; i++) {\n      if (i >= this._topPositions.length) { // perf optimization\n        this._topPositions.length += 100;\n      }\n\n      this._topPositions[i] = top;\n      top += this._getItemHeight(i);\n    }\n\n    if (this._delegate.hasRenderFunction && this._delegate.hasRenderFunction()) {\n      return this._delegate._render(start, i, () => {\n        this.padding = this._topPositions[start];\n      });\n    }\n\n    if (isScrollUp) {\n      for (let j = i - 1; j >= start; j--) {\n        keep[j] = true;\n        this._renderElement(j, isScrollUp);\n      }\n    } else {\n      const lastIndex = forceLastIndex || Math.max(i - 1, ...Object.keys(this._renderedItems)); // Recalculate for 0 or undefined\n      for (let j = start; j <= lastIndex; j++) {\n        keep[j] = true;\n        this._renderElement(j, isScrollUp);\n      }\n    }\n\n    Object.keys(this._renderedItems).forEach(key => keep[key] || this._removeElement(key, isScrollUp));\n  }\n\n  /**\n   * @param {Number} index\n   * @param {Boolean} isScrollUp\n   */\n  _renderElement(index, isScrollUp) {\n    const item = this._renderedItems[index];\n    if (item) {\n      this._delegate.updateItem(index, item); // update if it exists\n      return;\n    }\n\n    this._delegate.loadItemElement(index, item => {\n      if (isScrollUp) {\n        this._wrapperElement.insertBefore(item.element, this._wrapperElement.children[this._insertIndex]);\n        this.padding = this._topPositions[index];\n        item.height = this._topPositions[index + 1] - this._topPositions[index];\n      } else {\n        this._wrapperElement.appendChild(item.element);\n      }\n\n      this._renderedItems[index] = item;\n    });\n  }\n\n  /**\n   * @param {Number} index\n   * @param {Boolean} isScrollUp\n   */\n  _removeElement(index, isScrollUp = true) {\n    index = +(index);\n    const item = this._renderedItems[index];\n    this._delegate.destroyItem(index, item);\n\n    if (isScrollUp) {\n      this._topPositions[index + 1] = undefined;\n    } else {\n      this.padding = this.padding + this._getItemHeight(index);\n    }\n\n    if (item.element.parentElement) {\n      item.element.parentElement.removeChild(item.element);\n    }\n\n    delete this._renderedItems[index];\n  }\n\n  _removeAllElements() {\n    Object.keys(this._renderedItems).forEach(key => this._removeElement(key));\n  }\n\n  _recalculateTopPositions(start, end) {\n    for (let i = start; i <= end; i++) {\n      this._topPositions[i + 1] = this._topPositions[i] + this._getItemHeight(i);\n    }\n  }\n\n  _calculateStartIndex(current) {\n    const firstItemIndex = this._firstItemRendered();\n    const lastItemIndex = this._lastItemRendered();\n\n    // Fix for Safari scroll and Angular 2\n    this._recalculateTopPositions(firstItemIndex, lastItemIndex);\n\n    let start = 0;\n    let end = this._countItems() - 1;\n\n    // Binary search for index at top of screen so we can speed up rendering.\n    for (;;) {\n      const middle = Math.floor((start + end) / 2);\n      const value = current + this._topPositions[middle];\n\n      if (end < start) {\n        return 0;\n      } else if (value <= 0 && value + this._getItemHeight(middle) > 0) {\n        return middle;\n      } else if (isNaN(value) || value >= 0) {\n        end = middle - 1;\n      } else {\n        start = middle + 1;\n      }\n    }\n  }\n\n  _debounce(func, wait, immediate) {\n    let timeout;\n    return function() {\n      const callNow = immediate && !timeout;\n      clearTimeout(timeout);\n      if (callNow) {\n        func.apply(this, arguments);\n      } else {\n        timeout = setTimeout(() => {\n          timeout = null;\n          func.apply(this, arguments);\n        }, wait);\n      }\n    };\n  }\n\n  _doubleFireOnTouchend() {\n    this._render();\n    this._debounce(this._render.bind(this), 100);\n  }\n\n  _addEventListeners() {\n    util.bindListeners(this, ['_onChange', '_doubleFireOnTouchend']);\n\n    if (platform.isIOS()) {\n      this._boundOnChange = this._debounce(this._boundOnChange, 30);\n    }\n\n    this._pageContent.addEventListener('scroll', this._boundOnChange, true);\n\n    if (platform.isIOS()) {\n      util.addEventListener(this._pageContent, 'touchmove', this._boundOnChange, { capture: true, passive: true });\n      this._pageContent.addEventListener('touchend', this._boundDoubleFireOnTouchend, true);\n    }\n\n    window.document.addEventListener('resize', this._boundOnChange, true);\n  }\n\n  _removeEventListeners() {\n    this._pageContent.removeEventListener('scroll', this._boundOnChange, true);\n\n    if (platform.isIOS()) {\n      util.removeEventListener(this._pageContent, 'touchmove', this._boundOnChange, { capture: true, passive: true });\n      this._pageContent.removeEventListener('touchend', this._boundDoubleFireOnTouchend, true);\n    }\n\n    window.document.removeEventListener('resize', this._boundOnChange, true);\n  }\n\n  destroy() {\n    this._removeAllElements();\n    this._delegate.destroy();\n    this._parentElement = this._delegate = this._renderedItems = null;\n    this._removeEventListeners();\n  }\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}